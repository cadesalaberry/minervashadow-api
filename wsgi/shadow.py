from minervashadow import minerva
from functools import wraps
from flask import request

import json

def dummy_transcript():
	return {"description":"Bachelor of Software Engr Full-time Year 3 Software Engineering","diploma":"","education":"French Bacc in US","semesters":[{"advanced":[],"courses":[{"average":"B-","credits":"3","earned":"0","grade":"A","number":"002","remarks":"","subject":"COMP 202","title":"Intro to Computing 1"},{"average":"B-","credits":"3","earned":"0","grade":"A","number":"002","remarks":"","subject":"ECSE 200","title":"Electric Circuits 1"},{"average":"C+","credits":"3","earned":"0","grade":"A","number":"004","remarks":"","subject":"MATH 133","title":"Linear Algebra and Geometry"},{"average":"B","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"MATH 262","title":"Intermediate Calculus"},{"average":"B","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"MATH 263","title":"ODEs for Engineers"}],"description":None,"name":"2010 Fall","semester":"Fall","standing":"Probationary","year":"2010"},{"advanced":[],"courses":[{"average":"B+","credits":"4","earned":"4","grade":"A","number":"001","remarks":"","subject":"CHEM 120","title":"General Chemistry 2"},{"average":"B-","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"ECSE 210","title":"Electric Circuits 2"},{"average":"A-","credits":"2","earned":"2","grade":"A","number":"001","remarks":"","subject":"ECSE 291","title":"Electrical Measurements Lab"},{"average":"A-","credits":"1","earned":"1","grade":"A","number":"002","remarks":"","subject":"FACC 100","title":"Intro to the Eng. Profession"},{"average":"C+","credits":"3","earned":"0","grade":"A","number":"002","remarks":"","subject":"MATH 133","title":"Linear Algebra and Geometry"}],"description":None,"name":"2011 Winter","semester":"Winter","standing":"Continuing Unsat/Readmitted","year":"2011"},{"advanced":[],"courses":[{"average":"C+","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"MATH 262","title":"Intermediate Calculus"}],"description":None,"name":"2011 Summer","semester":"Summer","standing":"Unsatisfactory","year":"2011"},{"advanced":[],"courses":[{"average":"C+","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"CIVE 281","title":"Analytical Mechanics"},{"average":"B","credits":"3","earned":"0","grade":"A","number":"751","remarks":"","subject":"INDR 294","title":"Intro to Labour-Mgmt Relations"},{"average":"B","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"MATH 270","title":"Applied Linear Algebra"},{"average":"--","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"MIME 262","title":"Prop.Materials in Elec. Eng."}],"description":None,"name":"2011 Fall","semester":"Fall","standing":"Probationary","year":"2011"},{"advanced":[],"courses":[{"average":"A-","credits":"3","earned":"0","grade":"A","number":"710","remarks":"","subject":"CCOM 206","title":"Communication in Engineering"},{"average":"B-","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"ECSE 210","title":"Electric Circuits 2"},{"average":"B+","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"ECSE 211","title":"Design Principles and Methods"},{"average":"B","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"ECSE 221","title":"Intro to Computer Engineering"}],"description":None,"name":"2012 Winter","semester":"Winter","standing":"Satisfactory","year":"2012"},{"advanced":[],"courses":[{"average":"B-","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"MATH 264","title":"Adv Calculus for Engineers"}],"description":None,"name":"2012 Summer","semester":"Summer","standing":"Satisfactory","year":"2012"},{"advanced":[],"courses":[{"average":"B+","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"COMP 250","title":"Intro to Computer Science"},{"average":"--","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"ECSE 306","title":"Fund. of Signals and Systems"},{"average":"A-","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"ECSE 321","title":"Intro. to Software Engineering"},{"average":"B","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"ECSE 322","title":"Computer Engineering"}],"description":None,"name":"2012 Fall","semester":"Fall","standing":"Satisfactory","year":"2012"},{"advanced":[],"courses":[{"average":"B+","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"COMP 206","title":"Intro to Software Systems"},{"average":"B-","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"COMP 251","title":"Algorithms and Data Structures"},{"average":"B+","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"ECSE 427","title":"Operating Systems"},{"average":"A-","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"ECSE 428","title":"Software Engineering Practice"},{"average":"B+","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"MATH 363","title":"Discrete Mathematics"}],"description":None,"name":"2013 Winter","semester":"Winter","standing":"Satisfactory","year":"2013"},{"advanced":[],"courses":[{"average":"B","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"FACC 300","title":"Engineering Economy"}],"description":None,"name":"2013 Summer","semester":"Summer","standing":"Satisfactory","year":"2013"},{"advanced":[],"courses":[{"average":"--","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"COMP 302","title":"Programming Lang & Paradigms"},{"average":"--","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"ECSE 414","title":"Intro to Telecom Networks"},{"average":"--","credits":"3","earned":"0","grade":"A","number":"001","remarks":"","subject":"ECSE 420","title":"Parallel Computing"}],"description":None,"name":"2013 Fall","semester":"Fall","standing":"Satisfactory","year":"2013"},{"advanced":[],"courses":[],"description":None,"name":"2014 Winter","semester":"Winter","standing":None,"year":"2014"}]}

def login_ok(username, password):

	credentials = [username, password]
	_shadow = minerva.MinervaSession(credentials)

	if 'Welcome' in _shadow.login():
		return True
	return False


def get_transcript():

	_cred = request.authorization

	_credentials = [_cred.username, _cred.password]
	_shadow = minerva.MinervaSession(_credentials)
	_shadow.login()

	_curriculum = _shadow.transcript()
	_json = _curriculum.json()

	return json.loads(_json)